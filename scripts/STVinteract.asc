#pragma require "STVutil.asc"

#include "STVutil.asc"

int defaultInteractionTile = 118;

class Interaction
{
    int textID;
    int interactionTile;

    Vector2@ offset;

    bool overlapping;

    Interaction(int textID, Vector2@ offset = Vector2(0, -10), int interactionTile = defaultInteractionTile) {
        this.textID = textID;
        this.interactionTile = interactionTile;
        @this.offset = Vector2(x, y);

        for (int x = 1; x < 255; x++) {
            for(int y = 1; y < 64; y++) {
                // text event ID
                if (jjEventGet(x, y) == 207) { 
                    jjConsole("" + jjParameterGet(x, y, 8, 0));
                    if(jjParameterGet(x, y, 8, 0) == textID) {
                        jjConsole("NO");
                    }
                }
            }
        }
    }

    void update() {

    }

    void draw(jjCANVAS@ canvas) {
        if(overlapping) {
            canvas.drawTile(this.event.xPos + this.offset.x, this.event.yPos + this.offset.y);
        }
    }
};

arrray<Interaction@> interactions;

void registerInteraction(Interaction@ interaction) {
    interactions.insertLast(interaction);
}

void updateInteractions() {
    for (uint i = 0; i < interactios.length; i++)
    {
        Interaction@ interaction = interactions[i];
        interaction.update();
    }
}

void drawInteractions(jjCANVAS@ canvas) {
    for (uint i = 0; i < interactios.length; i++)
    {
        Interaction@ interaction = interactions[i];
        interaction.draw(canvas);
    }
}